function build_hdf5(debug, verbose)
%debug = 1 to skip loading data
%verbose = 1 for verbosity
if nargin && debug
    debug_string = '-DMATLAB_DEBUGGING';
else
    debug_string = '';
end
if nargin>1 && verbose
    verbose_string = '-DVERBOSE';
else
    verbose_string = '';
end
utils_folder = fileparts(mfilename('fullpath'));

switch computer('arch')
    case 'maci64'
        lib_folder = sprintf('%s%smexmaci64%s',utils_folder,filesep,filesep);
        mex('-v','loadSymphony2.cpp'...
            ,debug_string...
            ,verbose_string...
            ,'MACOSX_DEPLOYMENT_TARGET=11.6.2'...
            ,sprintf('%slibhdf5.a',lib_folder)...
            ,sprintf('%slibhdf5_cpp.a',lib_folder)...
            ,sprintf('%slibhdf5_hl.a',lib_folder)...
            ,sprintf('%slibhdf5_hl_cpp.a',lib_folder)...
            ,sprintf('%slibhdf5_tools.a',lib_folder)...
            ,sprintf('%slibsz.a',lib_folder)...
            ,sprintf('%slibz.a',lib_folder)... 
            ,sprintf('%slibaec.a',lib_folder)...
            ,sprintf('-I%s%sinclude',utils_folder,filesep)...
            );
%             ,sprintf('%slibhdf5_tools.a',lib_folder)...
%             ,sprintf('%slibsz.a',lib_folder)...
%             ,sprintf('%slibz.a',lib_folder)...
        
    case 'win64'
        mex('loadSymphony2.cpp'...
            ,debug_string...
            ,verbose_string...
            ,'libhdf5.lib','libhdf5_cpp.lib','libhdf5_hl.lib','libhdf5_tools.lib','libhdf5_hl_cpp.lib','libzlib.lib','libsz.lib','libaec.lib'...
            ,sprintf('-I%s%sinclude',utils_folder,filesep)...
            ,sprintf('-L%s%smexw64',utils_folder,filesep)...
            );
    otherwise
        error('Don''t know how to build for target system!');
end