utils_folder = fileparts(mfilename('fullpath'));

switch computer('arch')
    case 'maci64'
        mex('-v','loadSymphony2.cpp'...
            ,'libhdf5.a'...
            ,'libhdf5_cpp.a'...
            ,'libhdf5_hl.a'...
            ,'libhdf5_hl_cpp.a'...
            ,'libhdf5_tools.a'...    
            ,'/usr/local/opt/zlib/lib/libz.a'...
            ,sprintf('-I%s%sinclude',utils_folder,filesep)...
            ,sprintf('-L%s%smexmaci64',utils_folder,filesep)...
            );
    
    case 'win64'
        mex('loadSymphony2.cpp',...
            'libhdf5.lib','libhdf5_cpp.lib','libhdf5_hl.lib','libhdf5_tools.lib','libhdf5_hl_cpp.lib','libzlib.lib','libsz.lib','libaec.lib'...
            ,sprintf('-I%s%sinclude',utils_folder,filesep)...
            ,sprintf('-L%s%smexw64',utils_folder,filesep)...
            );
    otherwise
        error('Don''t know how to build for target system!');
end